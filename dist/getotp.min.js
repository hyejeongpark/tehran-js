(function(e){function t(){function t(){return"div#"+n.settings.iframe_container_id+" { position: fixed; bottom: 0; width: 100%; background-color: white; } div#"+n.settings.iframe_container_id+" iframe { border: 0; }"}function i(){var e=t();n.settings.css_rules=e}var s={iframe_container_id:"getotp_iframe_parent",iframe_container_class:"",iframe_id:"getotp_iframe",iframe_class:"",success_callback_function:"otpSuccess",failed_callback_function:"otpFailed",url_storage_key:"getotp_form_url"},n={settings:s,trusted_origins:["https://otp.dev"]};return i(),n.init=function(e){for(key in console.log("options",e),e)this.settings.hasOwnProperty(key)&&(this.settings[key]=e[key],"iframe_container_id"===key&&i());console.log("this",this)},n.getotpServerMessage=function(t){console.log("event",t);var i=e.location.origin;if(t.origin==i||n.trusted_origins.includes(t.origin)){var s=t.data;"function"==typeof n[s.func]&&n[s.func].call(null,s.message)}else console.error("Server callback failed because event origin "+t.origin+" is not define inside trusted_origins")},n.iframeHeightCallback=function(e){var t=e.embed_height;n.updateIframeHeight(t)},n.otpClientCallback=function(t){var i=t.otp_id,s=t.status,o=t.redirect_url,r={otp_id:i,status:s,redirect_url:o};"success"===s?"function"==typeof e[n.settings.success_callback_function]?e[n.settings.success_callback_function].call(null,r):console.error("To handle OTP success callback, please define function "+n.settings.success_callback_function+"(payload)"):"fail"===s&&("function"==typeof e[n.settings.failed_callback_function]?e[n.settings.failed_callback_function].call(null,r):console.error("To handle OTP error callback, please define function "+n.settings.failed_callback_function+"(payload)"))},n.embedOtpForm=function(e){var t=document.createElement("div");t.setAttribute("id",this.settings.iframe_container_id),t.setAttribute("class",this.settings.iframe_container_class);var i=document.createElement("iframe");i.setAttribute("id",this.settings.iframe_id),i.setAttribute("class",this.settings.iframe_class),t.appendChild(i),document.body.appendChild(t),i.src=e,i.width="100%";var s=document.createElement("style");s.appendChild(document.createTextNode(this.settings.css_rules)),document.getElementsByTagName("head")[0].appendChild(s)},n.showOtpForm=function(e){return console.log("this",this),sessionStorage.setItem(this.settings.url_storage_key,e),this.embedOtpForm(e),!0},n.updateIframeHeight=function(e){console.log("update iframe height",e),this.embed_height=e;var t=document.getElementById("getotp_iframe");t.style.height=e+"px"},n.reloadOtpForm=function(){var e=sessionStorage.getItem(this.settings.url_storage_key);e?this.embedOtpForm(e):console.error("No previous otp form url define in session storage with key "+this.settings.url_storage_key)},n.addOrigin=function(e){return this.trusted_origins.push(e),this.trusted_origins},n.clearSession=function(){sessionStorage.removeItem(this.settings.url_storage_key)},n}void 0===e.getotp&&(e.getotp=t()),e.addEventListener?e.addEventListener("message",e.getotp.getotpServerMessage,!1):e.attachEvent&&e.attachEvent("onmessage",e.getotp.getotpServerMessage,!1)})(window);