(function(e){function t(){var t={settings:{iframe_container_id:"getotp_iframe_parent",iframe_container_class:"",iframe_id:"getotp_iframe",iframe_class:"",success_callback_function:"otpSuccess",failed_callback_function:"otpFailed",url_storage_key:"getotp_form_url",trusted_origins:["https://otp.dev"]}},i="div#"+t.iframe_container_id+" { position: fixed; bottom: 0; width: 100%; background-color: white; } div#"+t.iframe_container_id+" iframe { border: 0; }";return t.settings.css_rules=i,t.init=function(e){for(key in console.log("options",e),e)this.settings.hasOwnProperty(key)&&(this.settings[key]=e[key]);console.log("this",this)},t.getotpServerMessage=function(i){console.log("event",i);var s=e.location.origin;if(i.origin==s||t.settings.trusted_origins.includes(i.origin)){var n=i.data;"function"==typeof t[n.func]&&t[n.func].call(null,n.message)}else console.error("Server callback failed because event origin "+i.origin+" is not define inside trusted_origins")},t.iframeHeightCallback=function(e){var i=e.embed_height;t.updateIframeHeight(i)},t.otpClientCallback=function(i){var s=i.otp_id,n=i.status,o=i.redirect_url,r={otp_id:s,status:n,redirect_url:o};"success"===n?"function"==typeof e[t.success_callback_function]?e[t.success_callback_function].call(null,r):console.error("To handle OTP success callback, please define function "+t.success_callback_function+"(payload)"):"fail"===n&&("function"==typeof e[t.failed_callback_function]?e[t.failed_callback_function].call(null,r):console.error("To handle OTP error callback, please define function "+t.failed_callback_function+"(payload)"))},t.embedOtpForm=function(e){var t=document.createElement("div");t.setAttribute("id",this.settings.iframe_container_id),t.setAttribute("class",this.settings.iframe_container_class);var i=document.createElement("iframe");i.setAttribute("id",this.settings.iframe_id),i.setAttribute("class",this.settings.iframe_class),t.appendChild(i),document.body.appendChild(t),i.src=e,i.width="100%";var s=document.createElement("style");s.appendChild(document.createTextNode(this.settings.css_rules)),document.getElementsByTagName("head")[0].appendChild(s)},t.showOtpForm=function(e){return console.log("this",this),sessionStorage.setItem(this.settings.url_storage_key,e),this.embedOtpForm(e),!0},t.updateIframeHeight=function(e){console.log("update iframe height",e),this.embed_height=e;var t=document.getElementById("getotp_iframe");t.style.height=e+"px"},t.reloadOtpForm=function(){var e=sessionStorage.getItem(this.settings.url_storage_key);e?this.embedOtpForm(e):console.error("No previous otp form url define in session storage with key "+this.settings.url_storage_key)},t.addOrigin=function(e){return this.settings.trusted_origins.push(e),this.settings.trusted_origins},t.clearSession=function(){sessionStorage.removeItem(this.settings.url_storage_key)},t}void 0===e.getotp&&(e.getotp=t()),e.addEventListener?e.addEventListener("message",e.getotp.getotpServerMessage,!1):e.attachEvent&&e.attachEvent("onmessage",e.getotp.getotpServerMessage,!1)})(window);